<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eic-smear: ParticleMC.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eic-smear
   &#160;<span id="projectnumber">1.0.3</span>
   </div>
   <div id="projectbrief">A collection of ROOT classes for Monte Carlo events and a fast-smearing code simulating detector effects for the Electron-Ion Collider task force</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('erhic_2_particle_m_c_8cxx_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">erhic/ParticleMC.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="erhic_2_particle_m_c_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="erhic_2_particle_m_c_8h.html">eicsmear/erhic/ParticleMC.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;TLorentzRotation.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;TParticlePDG.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;TRotation.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_event_base_8h.html">eicsmear/erhic/EventBase.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="functions_8h.html">eicsmear/functions.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> Returns the boost to transform to the rest frame of the vector &quot;rest&quot;.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> If z is non-NULL, rotate the frame so that z AFTER BOOSTING</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> defines the positive z direction of that frame.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> e.g. To boost a gamma-p interaction from the lab frame to the</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> proton rest frame with the virtual photon defining z:</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> computeBoost(protonLab, photonLab);</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;TLorentzRotation computeBoost(<span class="keyword">const</span> TLorentzVector&amp; rest,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                              <span class="keyword">const</span> TLorentzVector* z) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  TLorentzRotation toRest(-(rest.BoostVector()));</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">if</span> (z) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    TRotation rotate;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    TLorentzVector boostedZ(*z);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    boostedZ *= toRest;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    rotate.SetZAxis(boostedZ.Vect());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// We need the rotation of the frame, so take the inverse.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// See the TRotation documentation for more explanation.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    rotate = rotate.Inverse();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    toRest.Transform(rotate);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> toRest;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}  <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceerhic.html">erhic</a> {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a4836449525f64af1ec52ea7c8de7034c">   55</a></span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4836449525f64af1ec52ea7c8de7034c">ParticleMCbase::ParticleMCbase</a>()</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;: I(-1)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;, KS(-1)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;, id(std::numeric_limits&lt;Int_t&gt;::min())</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;, orig(-1)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;, daughter(-1)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;, ldaughter(-1)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;, px(0.)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;, py(0.)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;, pz(0.)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;, E(0.)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;, m(0.)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;, pt(0.)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;, xv(0.)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;, yv(0.)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;, zv(0.)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;, parentId(std::numeric_limits&lt;Int_t&gt;::min())</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;, p(0.)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;, theta(0.)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;, phi(0.)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;, rapidity(0.)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;, eta(0.)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;, z(0.)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;, xFeynman(0.)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;, thetaGamma(0.)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;, ptVsGamma(0.)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;, phiPrf(0.)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_c.html#a820a5bd25fc40b303f83caacb144ec98">   85</a></span>&#160;  <a class="code" href="classerhic_1_1_particle_m_c.html#ad2ac2e857c4fa4245006abdaaadf85c7">ParticleMC::ParticleMC</a>(<span class="keyword">const</span> std::string &amp;line, <span class="keywordtype">bool</span> eAflag): <a class="code" href="classerhic_1_1_particle_m_cbase.html">ParticleMCbase</a>(), eA(0) </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// Initialise to nonsense values to make input errors easy to spot</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span> (!line.empty()) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">static</span> std::stringstream ss;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    ss.clear();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    ss &lt;&lt; line;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (eAflag) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">eA</a> = <span class="keyword">new</span> <a class="code" href="classerhic_1_1_particle_m_ce_a.html">ParticleMCeA</a>();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      ss &gt;&gt;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//changed by liang to add particle mother1</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//    I &gt;&gt; KS &gt;&gt; id &gt;&gt; orig &gt;&gt; daughter &gt;&gt; ldaughter &gt;&gt;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a7e40f13ad161e151361ecd525c52c07d">I</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4aead1935954b7f74a0ae32c60e79c70">KS</a> &gt;&gt; <span class="keywordtype">id</span> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae097e92defa32aa925f76b553adde82d">orig1</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">orig</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">daughter</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4892e7f93bb1f450569d6e9676751184">ldaughter</a> &gt;&gt;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4d5e758cab1b081017c994bbb9bf1b45">xv</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a32f3e587ab7c413671d1ff7c4fba3b64">yv</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50fda7a92a5f3292eb1bcbda79ca475a">zv</a></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">//added by liang to include add particle data structure</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;     &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">eA</a>-&gt;<a class="code" href="classerhic_1_1_particle_m_ce_a.html#a2cf3f6b17caed7977d6d267f959a24cb">massNum</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">eA</a>-&gt;<a class="code" href="classerhic_1_1_particle_m_ce_a.html#a9f3e17e67cf809230026be2407899801">charge</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">eA</a>-&gt;<a class="code" href="classerhic_1_1_particle_m_ce_a.html#a50537ca2a7080204adc4f62d2c14ea0a">NoBam</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="comment">//eA-&gt;pz = pz; orig1 = eA-&gt;orig1; </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      ss &gt;&gt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a7e40f13ad161e151361ecd525c52c07d">I</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4aead1935954b7f74a0ae32c60e79c70">KS</a> &gt;&gt; <span class="keywordtype">id</span> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">orig</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">daughter</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4892e7f93bb1f450569d6e9676751184">ldaughter</a> &gt;&gt;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4d5e758cab1b081017c994bbb9bf1b45">xv</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a32f3e587ab7c413671d1ff7c4fba3b64">yv</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50fda7a92a5f3292eb1bcbda79ca475a">zv</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae097e92defa32aa925f76b553adde82d">orig1</a> = 0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    } <span class="comment">//if</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="comment">// We should have no stream errors and should have exhausted</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="comment">// the whole of the stream filling the particle.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (ss.fail() || !ss.eof()) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Bad particle input: &quot;</span> + line);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2aa0d72eeb2d16912348084513d9c78e">ComputeDerivedQuantities</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_c.html#a4fe691369f45d98f9068325141fb527e">  120</a></span>&#160;<a class="code" href="classerhic_1_1_particle_m_c.html#a4fe691369f45d98f9068325141fb527e">ParticleMC::~ParticleMC</a>() </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">eA</a>) <span class="keyword">delete</span> <a class="code" href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">eA</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// FIXME: may also want to print out ParticleMCeA variables?;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a1069762bb45eed975d1d112da221824a">  126</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#a1069762bb45eed975d1d112da221824a">ParticleMCbase::Print</a>(Option_t* <span class="comment">/* option */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  std::cout &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a7e40f13ad161e151361ecd525c52c07d">I</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4aead1935954b7f74a0ae32c60e79c70">KS</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">orig</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">daughter</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4892e7f93bb1f450569d6e9676751184">ldaughter</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4d5e758cab1b081017c994bbb9bf1b45">xv</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a32f3e587ab7c413671d1ff7c4fba3b64">yv</a> &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50fda7a92a5f3292eb1bcbda79ca475a">zv</a> &lt;&lt;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  std::endl;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a2aa0d72eeb2d16912348084513d9c78e">  133</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2aa0d72eeb2d16912348084513d9c78e">ParticleMCbase::ComputeDerivedQuantities</a>() {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// Calculate quantities that depend only on the properties already read.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a3dd442ef5b202c87b283fc07bf158d17">pt</a> = sqrt(pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a>, 2.) + pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a>, 2.));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a> = sqrt(pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a3dd442ef5b202c87b283fc07bf158d17">pt</a>, 2.) + pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>, 2.));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// Rapidity and pseudorapidity</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  Double_t Epluspz = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> + <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  Double_t Eminuspz = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> - <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  Double_t Ppluspz = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a> + <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  Double_t Pminuspz = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a> - <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">if</span> (Eminuspz &lt;= 0.0 || Pminuspz == 0.0 ||</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     Ppluspz == 0.0 || Epluspz &lt;= 0.0) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Dummy values to avoid zero or infinite arguments in calculations</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a0a284368ea276c09419b378a63d1b7ed">rapidity</a> = -19.;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a82acd09df22cdf91953b5dfa6024ee84">eta</a> = -19.;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a0a284368ea276c09419b378a63d1b7ed">rapidity</a> = 0.5 * log(Epluspz / Eminuspz);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a82acd09df22cdf91953b5dfa6024ee84">eta</a> = 0.5 * log(Ppluspz / Pminuspz);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a29fa227678b2bf5d08ea1577b1636b55">theta</a> = atan2(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a3dd442ef5b202c87b283fc07bf158d17">pt</a>, <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4b859944f2d7f81868852b0f5ff18552">phi</a> = TVector2::Phi_0_2pi(atan2(<a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a>, <a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a125e0b24d1d6b1bcf440f3265d4f60a5">  155</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#a125e0b24d1d6b1bcf440f3265d4f60a5">ParticleMCbase::ComputeEventDependentQuantities</a>(<a class="code" href="classerhic_1_1_event_m_c.html">EventMC</a>&amp; event) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Get the beam hadon, beam lepton and exchange boson.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">const</span> TLorentzVector&amp; hadron = <span class="keyword">event</span>.BeamHadron()-&gt;Get4Vector();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">const</span> TLorentzVector&amp; lepton = <span class="keyword">event</span>.ScatteredLepton()-&gt;Get4Vector();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">const</span> TLorentzVector&amp; boson = <span class="keyword">event</span>.ExchangeBoson()-&gt;Get4Vector();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// Calculate z using the 4-vector definition,</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// so we don&#39;t care about frame of reference.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a15d8d692ab7f1e04966caf156c07e8d9">z</a> = hadron.Dot(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a61678bfb002d139f288f09a0f30345c8">Get4Vector</a>()) / hadron.Dot(boson);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Calculate properties in the proton rest frame.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// We want pT and angle with respect to the virtual photon,</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// so use that to define the z axis.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    TLorentzRotation toHadronRest = computeBoost(hadron, &amp;boson);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Boost this particle to the proton rest frame and calculate its</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// pT and angle with respect to the virtual photon:</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    TLorentzVector <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a> = (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a61678bfb002d139f288f09a0f30345c8">Get4Vector</a>() *= toHadronRest);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">thetaGamma</a> = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>.Theta();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">ptVsGamma</a> =  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>.Pt();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// Calculate phi angle around virtual photon according</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// to the HERMES convention.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    TLorentzVector bosonPrf = (TLorentzVector(boson) *= toHadronRest);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    TLorentzVector leptonPrf = (TLorentzVector(lepton) *= toHadronRest);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a39043759c342a0d6aa7af5e0ef19e289">phiPrf</a> = <a class="code" href="functions_8cxx.html#a5f645a6689940a1ad8500ba581abeb1e">computeHermesPhiH</a>(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>, leptonPrf, bosonPrf);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// Feynman x with xF = 2 * pz / W in the boson-hadron CM frame.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// First boost to boson-hadron centre-of-mass frame.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Use the photon to define the z direction.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    TLorentzRotation boost = computeBoost(boson + hadron, &amp;boson);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#ada6af0711801dbb1cb8965a819839839">xFeynman</a> = 2. * (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a61678bfb002d139f288f09a0f30345c8">Get4Vector</a>() *= boost).Pz() / sqrt(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a7e647d24a8ef8befbd80b7ab0562d461">event</a>.GetW2());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Determine the PDG code of the parent particle, if the particle</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// has a parent and the parent is present in the particle array.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// The index of the particles from the Monte Carlo runs from [1,N]</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// while the index in the array runs from [0,N-1], so subtract 1</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// from the parent index to find its position.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a7e647d24a8ef8befbd80b7ab0562d461">event</a>.GetNTracks() &gt; <span class="keywordtype">unsigned</span>(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">orig</a> - 1)) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="classerhic_1_1_particle_m_cbase.html#accd6d19657815e5880480b393d3e2a69">parentId</a> = <span class="keyword">event</span>.GetTrack(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">orig</a> - 1)-&gt;Id();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }  <span class="comment">// try</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">catch</span>(std::exception&amp; e) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    std::cerr &lt;&lt;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="stringliteral">&quot;Exception in Particle::ComputeEventDependentQuantities: &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    e.what() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }  <span class="comment">// catch</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a61678bfb002d139f288f09a0f30345c8">  199</a></span>&#160;TLorentzVector <a class="code" href="classerhic_1_1_particle_m_cbase.html#a61678bfb002d139f288f09a0f30345c8">ParticleMCbase::Get4Vector</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">return</span> TLorentzVector(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a>, <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a>, <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a>, <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">  203</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classerhic_1_1_event_m_c.html">EventMC</a>* <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">ParticleMCbase::GetEvent</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classerhic_1_1_event_m_c.html">EventMC</a>*<span class="keyword">&gt;</span>(<span class="keyword">event</span>.GetObject());</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_c.html#a4625fd1c64984b9b2dbc338abbef00f4">  207</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classerhic_1_1_particle_m_c.html">ParticleMC</a>* <a class="code" href="classerhic_1_1_particle_m_c.html#a4625fd1c64984b9b2dbc338abbef00f4">ParticleMC::GetChild</a>(UShort_t u)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// Look up this particle&#39;s child via the event</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// containing it and the index of the child in that event.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     <span class="comment">// index is in the range [1,N]</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordtype">unsigned</span> idx = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">daughter</a> + u;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">daughter</a> &lt; 1 ||  <span class="comment">// If first daughter index = 0, it has no children</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      u &gt;= <a class="code" href="classerhic_1_1_particle_m_cbase.html#a7a235fce797e95f50b971acff304f637">GetNChildren</a>()) {  <span class="comment">// Insufficient children</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  --idx;  <span class="comment">// Convert [1,N] --&gt; [0,N)</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">const</span> <a class="code" href="classerhic_1_1_particle_m_c.html">ParticleMC</a>* <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>(NULL);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Check this index is within the # of particles in the event</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span> (idx &lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;GetNTracks()) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a> = <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;<a class="code" href="classerhic_1_1_event_m_c.html#af003864102ee9f4facd84b0743d66540">GetTrack</a>(idx);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_c.html#ab0fb377ff9f18509ba744454aef53e56">  228</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classerhic_1_1_particle_m_c.html">ParticleMC</a>* <a class="code" href="classerhic_1_1_particle_m_c.html#ab0fb377ff9f18509ba744454aef53e56">ParticleMC::GetParent</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Look up this particle&#39;s parent via the event</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// containing it and the index of the parent in that event.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keyword">const</span> <a class="code" href="classerhic_1_1_particle_m_c.html">ParticleMC</a>* <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>(NULL);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;GetNTracks() &gt;= <a class="code" href="classerhic_1_1_particle_m_cbase.html#a417265d7513cb5e84ddd3e9317f0169a">GetParentIndex</a>()) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a> = <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;<a class="code" href="classerhic_1_1_event_m_c.html#af003864102ee9f4facd84b0743d66540">GetTrack</a>(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a417265d7513cb5e84ddd3e9317f0169a">GetParentIndex</a>() - 1);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">p</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_c.html#ab039e800a3a0112b77ed3c0dcce1784c">  240</a></span>&#160;Bool_t <a class="code" href="classerhic_1_1_particle_m_c.html#ab039e800a3a0112b77ed3c0dcce1784c">ParticleMC::HasChild</a>(Int_t pdg)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (UInt_t i(0); i &lt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a7a235fce797e95f50b971acff304f637">GetNChildren</a>(); ++i) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classerhic_1_1_particle_m_c.html#a4625fd1c64984b9b2dbc338abbef00f4">GetChild</a>(i)) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (pdg == <a class="code" href="classerhic_1_1_particle_m_c.html#a4625fd1c64984b9b2dbc338abbef00f4">GetChild</a>(i)-&gt;<a class="code" href="classerhic_1_1_particle_m_cbase.html#afb4fa19db70500fc783756e78f7c66ae">Id</a>()) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }  <span class="comment">// for</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a023f9e487b704774313cc70cedc9714e">  252</a></span>&#160;TLorentzVector <a class="code" href="classerhic_1_1_particle_m_cbase.html#a023f9e487b704774313cc70cedc9714e">ParticleMCbase::Get4VectorInHadronBosonFrame</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordtype">double</span> p_(0.), e_(0.), px_(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">ptVsGamma</a>), py_(0.), pz_(0.);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// Calculate mangitude of momentum from pT and polar angle in</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// hadron-boson frame. If theta is ~parallel to the beam just set</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// p to whatever pT is (not that it makes all that much sense).</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">thetaGamma</a> &gt; 1.e-6) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    p_ = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">ptVsGamma</a> / sin(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">thetaGamma</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// Deal with virtual particles later, so check if particle is off mass-shell</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> &lt; 0.)) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    e_ = sqrt(pow(p_, 2.) + pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a>, 2.));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    e_ = sqrt(pow(p_, 2.) - pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a>, 2.));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (TMath::IsNaN(e_)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      e_ = 0.;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// Calculate pZ from pT and theta, unless it&#39;s very close to the beam,</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// in which case set it to p.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">thetaGamma</a> &gt; 1.e-6) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    pz_ = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">ptVsGamma</a> / tan(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">thetaGamma</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Calculate px and py, unless a dummy phi value is present.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a39043759c342a0d6aa7af5e0ef19e289">phiPrf</a> &gt; -100.) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    px_ = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">ptVsGamma</a> * cos(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a39043759c342a0d6aa7af5e0ef19e289">phiPrf</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    py_ = <a class="code" href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">ptVsGamma</a> * sin(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a39043759c342a0d6aa7af5e0ef19e289">phiPrf</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// If we ended up with no energy, it&#39;s likely ths is the exchange boson,</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// as nothing will have happened above. If so, try to reference the event</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// record to get the necessary information, as we don&#39;t have enough</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// in the particle itself.</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Note that this appears not to work in a TTree as ROOT doesn&#39;t read</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// the event when it reads the particle, though I&#39;m not certain of the</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// exact cause.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> &lt; 0. &amp;&amp; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;ExchangeBoson()) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">// Don&#39;t check if GetEvent()-&gt;ExchangeBoson() == this, in case this</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// particle is a copy of the event track that isn&#39;t part of a copied</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="comment">// event.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;ExchangeBoson()-&gt;<a class="code" href="classerhic_1_1_particle_m_cbase.html#a94a68fc034b51d42cf5b2d37d39884f1">GetIndex</a>() == <a class="code" href="classerhic_1_1_particle_m_cbase.html#a94a68fc034b51d42cf5b2d37d39884f1">GetIndex</a>()) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// If it&#39;s the exchange boson just set E == nu.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        e_ = <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">GetEvent</a>()-&gt;<a class="code" href="classerhic_1_1_event_dis.html#ad494e0d81fdfaa4dd5235c38590439e5">GetNu</a>();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// Calculate p, careful about negative mass.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        p_ = sqrt(pow(e_, 2.) + pow(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a>, 2.));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        pz_ = p_ * cos(<a class="code" href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">thetaGamma</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      }  <span class="comment">// if</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span> TLorentzVector(px_, py_, pz_, e_);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#ab65bcb7673eb964e91515ee0ab697d01">  303</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#ab65bcb7673eb964e91515ee0ab697d01">ParticleMCbase::SetEvent</a>(<a class="code" href="classerhic_1_1_event_m_c.html">EventMC</a>* e) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keyword">event</span> = e;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#af3dbf2a11907f0057b6cfc1af30e5b75">  307</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#af3dbf2a11907f0057b6cfc1af30e5b75">ParticleMCbase::Set4Vector</a>(<span class="keyword">const</span> TLorentzVector&amp; v) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> = v.Energy();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a> = v.Px();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a> = v.Py();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a> = v.Pz();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> = v.M();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2aa0d72eeb2d16912348084513d9c78e">ComputeDerivedQuantities</a>();  <span class="comment">// Rapidity etc</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// If an event reference is set, recalculate event-dependent quantities</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// like z, xF</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="classerhic_1_1_event_m_c.html">EventMC</a>* ev = <span class="keyword">static_cast&lt;</span><a class="code" href="classerhic_1_1_event_m_c.html">EventMC</a>*<span class="keyword">&gt;</span>(<span class="keyword">event</span>.GetObject());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span> (ev) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a125e0b24d1d6b1bcf440f3265d4f60a5">ComputeEventDependentQuantities</a>(*ev);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classerhic_1_1_particle_m_cbase.html#a72a8e62968d27cc591dbd1b03c8436e9">  322</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classerhic_1_1_particle_m_cbase.html#a72a8e62968d27cc591dbd1b03c8436e9">ParticleMCbase::SetVertex</a>(<span class="keyword">const</span> TVector3&amp; v) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4d5e758cab1b081017c994bbb9bf1b45">xv</a> = v.X();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a32f3e587ab7c413671d1ff7c4fba3b64">yv</a> = v.Y();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50fda7a92a5f3292eb1bcbda79ca475a">zv</a> = v.Z();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">#if _OLD_</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<a class="code" href="classerhic_1_1_particle_m_ce_a.html#a21f358c8bffedcddbde0304742e63833">ParticleMCeA::ParticleMCeA</a>(<span class="keyword">const</span> std::string&amp; line)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;: <span class="comment">/*I(-1)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">, KS(-1)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">, id(std::numeric_limits&lt;Int_t&gt;::min())</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">, orig(-1)</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">, daughter(-1)</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">, ldaughter(-1)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">, px(0.)</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">, py(0.)</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">, pz(0.)</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">, E(0.)</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">, m(0.)</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">, pt(0.)</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">, xv(0.)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">, yv(0.)</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">, zv(0.)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">, parentId(std::numeric_limits&lt;Int_t&gt;::min())</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">, p(0.)</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">, theta(0.)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">, phi(0.)</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">, rapidity(0.)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">, eta(0.)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">, z(0.)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">, xFeynman(0.)</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">, thetaGamma(0.)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">, ptVsGamma(0.)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">, phiPrf(0.) </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">//added by liang to include add particle data structure</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">,*/</span> orig1(-1)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;, charge(-999)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;, massNum(-999) </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;, NoBam(-999) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// Initialise to nonsense values to make input errors easy to spot</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span> (!line.empty()) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">static</span> std::stringstream ss;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    ss.clear();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    ss &lt;&lt; line;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    ss &gt;&gt;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//changed by liang to add particle mother1</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">//    I &gt;&gt; KS &gt;&gt; id &gt;&gt; orig &gt;&gt; daughter &gt;&gt; ldaughter &gt;&gt;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a7e40f13ad161e151361ecd525c52c07d">I</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4aead1935954b7f74a0ae32c60e79c70">KS</a> &gt;&gt; <span class="keywordtype">id</span> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae097e92defa32aa925f76b553adde82d">orig1</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">orig</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">daughter</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4892e7f93bb1f450569d6e9676751184">ldaughter</a> &gt;&gt;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">px</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">py</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">pz</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">E</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">m</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a4d5e758cab1b081017c994bbb9bf1b45">xv</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a32f3e587ab7c413671d1ff7c4fba3b64">yv</a> &gt;&gt; <a class="code" href="classerhic_1_1_particle_m_cbase.html#a50fda7a92a5f3292eb1bcbda79ca475a">zv</a></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">//added by liang to include add particle data structure</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    &gt;&gt; massNum &gt;&gt; charge &gt;&gt; NoBam;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// We should have no stream errors and should have exhausted</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// the whole of the stream filling the particle.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (ss.fail() || !ss.eof()) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Bad particle input: &quot;</span> + line);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }  <span class="comment">// if</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classerhic_1_1_particle_m_cbase.html#a2aa0d72eeb2d16912348084513d9c78e">ComputeDerivedQuantities</a>();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }  <span class="comment">// if</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}  <span class="comment">// namespace erhic</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html_a4fe691369f45d98f9068325141fb527e"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html#a4fe691369f45d98f9068325141fb527e">erhic::ParticleMC::~ParticleMC</a></div><div class="ttdeci">~ParticleMC()</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00120">erhic/ParticleMC.cxx:120</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a4aead1935954b7f74a0ae32c60e79c70"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a4aead1935954b7f74a0ae32c60e79c70">erhic::ParticleMCbase::KS</a></div><div class="ttdeci">Int_t KS</div><div class="ttdoc">Particle status code: see PYTHIA manual.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00334">erhic/ParticleMC.h:334</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_ce_a_html"><div class="ttname"><a href="classerhic_1_1_particle_m_ce_a.html">erhic::ParticleMCeA</a></div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00024">erhic/ParticleMC.h:24</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_afb4fa19db70500fc783756e78f7c66ae"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#afb4fa19db70500fc783756e78f7c66ae">erhic::ParticleMCbase::Id</a></div><div class="ttdeci">virtual Pid Id() const</div><div class="ttdoc">Returns the ID of the particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00544">erhic/ParticleMC.h:544</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html_ab0fb377ff9f18509ba744454aef53e56"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html#ab0fb377ff9f18509ba744454aef53e56">erhic::ParticleMC::GetParent</a></div><div class="ttdeci">virtual const ParticleMC * GetParent() const</div><div class="ttdoc">Returns a pointer to the parent of this particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00228">erhic/ParticleMC.cxx:228</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_ce_a_html_a50537ca2a7080204adc4f62d2c14ea0a"><div class="ttname"><a href="classerhic_1_1_particle_m_ce_a.html#a50537ca2a7080204adc4f62d2c14ea0a">erhic::ParticleMCeA::NoBam</a></div><div class="ttdeci">Int_t NoBam</div><div class="ttdoc">0, 2 create in hard collisions not affected by INC: 0 inside nucleus, 2 outside nucleus;</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00033">erhic/ParticleMC.h:33</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a94d8c177c45e1832c2ea7530d6a9267e"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a94d8c177c45e1832c2ea7530d6a9267e">erhic::ParticleMCbase::ptVsGamma</a></div><div class="ttdeci">Double32_t ptVsGamma</div><div class="ttdoc">pt w.r.t.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00388">erhic/ParticleMC.h:388</a></div></div>
<div class="ttc" id="anamespaceerhic_html"><div class="ttname"><a href="namespaceerhic.html">erhic</a></div><div class="ttdef"><b>Definition:</b> <a href="_event_dis_8cxx_source.html#l00014">EventDis.cxx:14</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a32f3e587ab7c413671d1ff7c4fba3b64"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a32f3e587ab7c413671d1ff7c4fba3b64">erhic::ParticleMCbase::yv</a></div><div class="ttdeci">Double_t yv</div><div class="ttdoc">y coordinate of particle production vertex</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00372">erhic/ParticleMC.h:372</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a39043759c342a0d6aa7af5e0ef19e289"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a39043759c342a0d6aa7af5e0ef19e289">erhic::ParticleMCbase::phiPrf</a></div><div class="ttdeci">Double32_t phiPrf</div><div class="ttdoc">Azimuthal angle around virtual photon in hadron beam rest frame.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00390">erhic/ParticleMC.h:390</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a61678bfb002d139f288f09a0f30345c8"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a61678bfb002d139f288f09a0f30345c8">erhic::ParticleMCbase::Get4Vector</a></div><div class="ttdeci">virtual TLorentzVector Get4Vector() const</div><div class="ttdoc">Returns the (E,p) 4-vector in the lab frame.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00199">erhic/ParticleMC.cxx:199</a></div></div>
<div class="ttc" id="aclasserhic_1_1_event_dis_html_ad494e0d81fdfaa4dd5235c38590439e5"><div class="ttname"><a href="classerhic_1_1_event_dis.html#ad494e0d81fdfaa4dd5235c38590439e5">erhic::EventDis::GetNu</a></div><div class="ttdeci">virtual Double_t GetNu() const</div><div class="ttdoc">Returns the exchange boson energy in the beam hadron rest frame.</div><div class="ttdef"><b>Definition:</b> <a href="_event_dis_8h_source.html#l00202">EventDis.h:202</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html_ad2ac2e857c4fa4245006abdaaadf85c7"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html#ad2ac2e857c4fa4245006abdaaadf85c7">erhic::ParticleMC::ParticleMC</a></div><div class="ttdeci">ParticleMC()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00411">erhic/ParticleMC.h:411</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_ae901f7c7083dde3da6b91dd896d144a5"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#ae901f7c7083dde3da6b91dd896d144a5">erhic::ParticleMCbase::py</a></div><div class="ttdeci">Double_t py</div><div class="ttdoc">y component of particle momentum</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00346">erhic/ParticleMC.h:346</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a7a235fce797e95f50b971acff304f637"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a7a235fce797e95f50b971acff304f637">erhic::ParticleMCbase::GetNChildren</a></div><div class="ttdeci">virtual UInt_t GetNChildren() const</div><div class="ttdoc">Returns the number of children of this particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00548">erhic/ParticleMC.h:548</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a2493f5c26766aeb2208962c322612fd7"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a2493f5c26766aeb2208962c322612fd7">erhic::ParticleMCbase::pz</a></div><div class="ttdeci">Double_t pz</div><div class="ttdoc">z component of particle momentum</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00347">erhic/ParticleMC.h:347</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a4836449525f64af1ec52ea7c8de7034c"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a4836449525f64af1ec52ea7c8de7034c">erhic::ParticleMCbase::ParticleMCbase</a></div><div class="ttdeci">ParticleMCbase()</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00055">erhic/ParticleMC.cxx:55</a></div></div>
<div class="ttc" id="a_event_base_8h_html"><div class="ttname"><a href="_event_base_8h.html">EventBase.h</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html">erhic::ParticleMCbase</a></div><div class="ttdoc">A particle produced by a Monte Carlo generator.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00043">erhic/ParticleMC.h:43</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a0db8f7823daa7dbafd9417870b65df34"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a0db8f7823daa7dbafd9417870b65df34">erhic::ParticleMCbase::thetaGamma</a></div><div class="ttdeci">Double32_t thetaGamma</div><div class="ttdoc">Angle between particle and the exchange boson in the hadron beam rest frame.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00386">erhic/ParticleMC.h:386</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_ce_a_html_a21f358c8bffedcddbde0304742e63833"><div class="ttname"><a href="classerhic_1_1_particle_m_ce_a.html#a21f358c8bffedcddbde0304742e63833">erhic::ParticleMCeA::ParticleMCeA</a></div><div class="ttdeci">ParticleMCeA()</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00026">erhic/ParticleMC.h:26</a></div></div>
<div class="ttc" id="afunctions_8h_html"><div class="ttname"><a href="functions_8h.html">functions.h</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a78161a47bc20cf100c6a03471fc241a4"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a78161a47bc20cf100c6a03471fc241a4">erhic::ParticleMCbase::m</a></div><div class="ttdeci">Double32_t m</div><div class="ttdoc">Invariant mass of particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00369">erhic/ParticleMC.h:369</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a0a284368ea276c09419b378a63d1b7ed"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a0a284368ea276c09419b378a63d1b7ed">erhic::ParticleMCbase::rapidity</a></div><div class="ttdeci">Double32_t rapidity</div><div class="ttdoc">Rapidity of particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00381">erhic/ParticleMC.h:381</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a6bb758873dcd19031b36d5b64a6d02bc"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a6bb758873dcd19031b36d5b64a6d02bc">erhic::ParticleMCbase::orig</a></div><div class="ttdeci">UShort_t orig</div><div class="ttdoc">I of parent particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00338">erhic/ParticleMC.h:338</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a4097792d3569b226acde60bc00466e7c"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a4097792d3569b226acde60bc00466e7c">erhic::ParticleMCbase::daughter</a></div><div class="ttdeci">UShort_t daughter</div><div class="ttdoc">I of first child particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00340">erhic/ParticleMC.h:340</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html_ab039e800a3a0112b77ed3c0dcce1784c"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html#ab039e800a3a0112b77ed3c0dcce1784c">erhic::ParticleMC::HasChild</a></div><div class="ttdeci">virtual Bool_t HasChild(Int_t) const</div><div class="ttdoc">Returns true if n in the range [0, N), where N is the number of children of this particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00240">erhic/ParticleMC.cxx:240</a></div></div>
<div class="ttc" id="afunctions_8cxx_html_a5f645a6689940a1ad8500ba581abeb1e"><div class="ttname"><a href="functions_8cxx.html#a5f645a6689940a1ad8500ba581abeb1e">computeHermesPhiH</a></div><div class="ttdeci">double computeHermesPhiH(const TLorentzVector &amp;hadronInPrf, const TLorentzVector &amp;leptonInPrf, const TLorentzVector &amp;photonInPrf)</div><div class="ttdoc">Calculate the hadron azimuthal angle around the virtual photon direction with respect to the lepton s...</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cxx_source.html#l00052">functions.cxx:52</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_accd6d19657815e5880480b393d3e2a69"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#accd6d19657815e5880480b393d3e2a69">erhic::ParticleMCbase::parentId</a></div><div class="ttdeci">Int_t parentId</div><div class="ttdoc">PDG code of this particle's parent.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00376">erhic/ParticleMC.h:376</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_ae097e92defa32aa925f76b553adde82d"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#ae097e92defa32aa925f76b553adde82d">erhic::ParticleMCbase::orig1</a></div><div class="ttdeci">UShort_t orig1</div><div class="ttdoc">I of parent particle1.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00339">erhic/ParticleMC.h:339</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a417265d7513cb5e84ddd3e9317f0169a"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a417265d7513cb5e84ddd3e9317f0169a">erhic::ParticleMCbase::GetParentIndex</a></div><div class="ttdeci">virtual UShort_t GetParentIndex() const</div><div class="ttdoc">Returns the index of this particle's parent in an event.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00465">erhic/ParticleMC.h:465</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a50f957c7c1c221be64a1e4542ba61bc8"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a50f957c7c1c221be64a1e4542ba61bc8">erhic::ParticleMCbase::p</a></div><div class="ttdeci">Double32_t p</div><div class="ttdoc">Total momentum of particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00378">erhic/ParticleMC.h:378</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a023f9e487b704774313cc70cedc9714e"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a023f9e487b704774313cc70cedc9714e">erhic::ParticleMCbase::Get4VectorInHadronBosonFrame</a></div><div class="ttdeci">virtual TLorentzVector Get4VectorInHadronBosonFrame() const</div><div class="ttdoc">Returns the (E,p) 4-vector in the hadron-boson frame.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00252">erhic/ParticleMC.cxx:252</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html_a58a79cc1276350f2995442c78b33cc3e"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html#a58a79cc1276350f2995442c78b33cc3e">erhic::ParticleMC::eA</a></div><div class="ttdeci">ParticleMCeA * eA</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00451">erhic/ParticleMC.h:451</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a94a68fc034b51d42cf5b2d37d39884f1"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a94a68fc034b51d42cf5b2d37d39884f1">erhic::ParticleMCbase::GetIndex</a></div><div class="ttdeci">virtual UInt_t GetIndex() const</div><div class="ttdoc">Returns the particle index in an event, in the range [1, N].</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00457">erhic/ParticleMC.h:457</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a125e0b24d1d6b1bcf440f3265d4f60a5"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a125e0b24d1d6b1bcf440f3265d4f60a5">erhic::ParticleMCbase::ComputeEventDependentQuantities</a></div><div class="ttdeci">virtual void ComputeEventDependentQuantities(EventMC &amp;)</div><div class="ttdoc">Sets quantities that depend on the properties of the event or associations of one particle with anoth...</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00155">erhic/ParticleMC.cxx:155</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a583c8908b6b9e01ce839f1d83ecf7ce0"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a583c8908b6b9e01ce839f1d83ecf7ce0">erhic::ParticleMCbase::E</a></div><div class="ttdeci">Double32_t E</div><div class="ttdoc">Energy of particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00368">erhic/ParticleMC.h:368</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a1069762bb45eed975d1d112da221824a"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a1069762bb45eed975d1d112da221824a">erhic::ParticleMCbase::Print</a></div><div class="ttdeci">virtual void Print(Option_t *=&quot;&quot;) const</div><div class="ttdoc">Print the contents of Particle to standard output.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00126">erhic/ParticleMC.cxx:126</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html_a4625fd1c64984b9b2dbc338abbef00f4"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html#a4625fd1c64984b9b2dbc338abbef00f4">erhic::ParticleMC::GetChild</a></div><div class="ttdeci">virtual const ParticleMC * GetChild(UShort_t) const</div><div class="ttdoc">Returns a pointer to the nth child particle of this particle, where n is in the range [0,...</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00207">erhic/ParticleMC.cxx:207</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_ada6af0711801dbb1cb8965a819839839"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#ada6af0711801dbb1cb8965a819839839">erhic::ParticleMCbase::xFeynman</a></div><div class="ttdeci">Double32_t xFeynman</div><div class="ttdoc">Feynman x = pz/(2sqrt(s))</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00385">erhic/ParticleMC.h:385</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_c_html"><div class="ttname"><a href="classerhic_1_1_particle_m_c.html">erhic::ParticleMC</a></div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00403">erhic/ParticleMC.h:403</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_ce_a_html_a2cf3f6b17caed7977d6d267f959a24cb"><div class="ttname"><a href="classerhic_1_1_particle_m_ce_a.html#a2cf3f6b17caed7977d6d267f959a24cb">erhic::ParticleMCeA::massNum</a></div><div class="ttdeci">Int_t massNum</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00032">erhic/ParticleMC.h:32</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a948068175655c6d23dd2f9cfc1646624"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a948068175655c6d23dd2f9cfc1646624">erhic::ParticleMCbase::px</a></div><div class="ttdeci">Double_t px</div><div class="ttdoc">x component of particle momentum</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00345">erhic/ParticleMC.h:345</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a72a8e62968d27cc591dbd1b03c8436e9"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a72a8e62968d27cc591dbd1b03c8436e9">erhic::ParticleMCbase::SetVertex</a></div><div class="ttdeci">virtual void SetVertex(const TVector3 &amp;)</div><div class="ttdoc">Sets the origin coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00322">erhic/ParticleMC.cxx:322</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_ab9cec02e34316eb419b4e9d98db181b7"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#ab9cec02e34316eb419b4e9d98db181b7">erhic::ParticleMCbase::GetEvent</a></div><div class="ttdeci">const EventMC * GetEvent() const</div><div class="ttdoc">Returns a pointer to the event containing this particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00203">erhic/ParticleMC.cxx:203</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a50fda7a92a5f3292eb1bcbda79ca475a"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a50fda7a92a5f3292eb1bcbda79ca475a">erhic::ParticleMCbase::zv</a></div><div class="ttdeci">Double_t zv</div><div class="ttdoc">z coordinate of particle production vertex</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00373">erhic/ParticleMC.h:373</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a4892e7f93bb1f450569d6e9676751184"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a4892e7f93bb1f450569d6e9676751184">erhic::ParticleMCbase::ldaughter</a></div><div class="ttdeci">UShort_t ldaughter</div><div class="ttdoc">I of last child particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00341">erhic/ParticleMC.h:341</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a3dd442ef5b202c87b283fc07bf158d17"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a3dd442ef5b202c87b283fc07bf158d17">erhic::ParticleMCbase::pt</a></div><div class="ttdeci">Double32_t pt</div><div class="ttdoc">Transverse momentum of particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00370">erhic/ParticleMC.h:370</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a2aa0d72eeb2d16912348084513d9c78e"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a2aa0d72eeb2d16912348084513d9c78e">erhic::ParticleMCbase::ComputeDerivedQuantities</a></div><div class="ttdeci">virtual void ComputeDerivedQuantities()</div><div class="ttdoc">Sets quantities derived from the four-momentum (E, px, py, pz), namely.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00133">erhic/ParticleMC.cxx:133</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a29fa227678b2bf5d08ea1577b1636b55"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a29fa227678b2bf5d08ea1577b1636b55">erhic::ParticleMCbase::theta</a></div><div class="ttdeci">Double32_t theta</div><div class="ttdoc">Polar angle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00379">erhic/ParticleMC.h:379</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a7e40f13ad161e151361ecd525c52c07d"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a7e40f13ad161e151361ecd525c52c07d">erhic::ParticleMCbase::I</a></div><div class="ttdeci">UShort_t I</div><div class="ttdoc">Particle index in event.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00331">erhic/ParticleMC.h:331</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_ce_a_html_a9f3e17e67cf809230026be2407899801"><div class="ttname"><a href="classerhic_1_1_particle_m_ce_a.html#a9f3e17e67cf809230026be2407899801">erhic::ParticleMCeA::charge</a></div><div class="ttdeci">Int_t charge</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00027">erhic/ParticleMC.h:27</a></div></div>
<div class="ttc" id="aclasserhic_1_1_event_m_c_html_af003864102ee9f4facd84b0743d66540"><div class="ttname"><a href="classerhic_1_1_event_m_c.html#af003864102ee9f4facd84b0743d66540">erhic::EventMC::GetTrack</a></div><div class="ttdeci">virtual const ParticleMC * GetTrack(UInt_t) const</div><div class="ttdoc">Returns the nth track.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_event_m_c_8h_source.html#l00227">erhic/EventMC.h:227</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a4d5e758cab1b081017c994bbb9bf1b45"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a4d5e758cab1b081017c994bbb9bf1b45">erhic::ParticleMCbase::xv</a></div><div class="ttdeci">Double_t xv</div><div class="ttdoc">x coordinate of particle production vertex</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00371">erhic/ParticleMC.h:371</a></div></div>
<div class="ttc" id="aerhic_2_particle_m_c_8h_html"><div class="ttname"><a href="erhic_2_particle_m_c_8h.html">ParticleMC.h</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a82acd09df22cdf91953b5dfa6024ee84"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a82acd09df22cdf91953b5dfa6024ee84">erhic::ParticleMCbase::eta</a></div><div class="ttdeci">Double32_t eta</div><div class="ttdoc">Pseudorapidity of particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00382">erhic/ParticleMC.h:382</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_ab65bcb7673eb964e91515ee0ab697d01"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#ab65bcb7673eb964e91515ee0ab697d01">erhic::ParticleMCbase::SetEvent</a></div><div class="ttdeci">void SetEvent(EventMC *event)</div><div class="ttdoc">Set the event with which to associate this particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00303">erhic/ParticleMC.cxx:303</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_af3dbf2a11907f0057b6cfc1af30e5b75"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#af3dbf2a11907f0057b6cfc1af30e5b75">erhic::ParticleMCbase::Set4Vector</a></div><div class="ttdeci">virtual void Set4Vector(const TLorentzVector &amp;)</div><div class="ttdoc">Sets the four-momentum of the particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8cxx_source.html#l00307">erhic/ParticleMC.cxx:307</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a15d8d692ab7f1e04966caf156c07e8d9"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a15d8d692ab7f1e04966caf156c07e8d9">erhic::ParticleMCbase::z</a></div><div class="ttdeci">Double32_t z</div><div class="ttdoc">Fraction of virtual photon energy carried by particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00383">erhic/ParticleMC.h:383</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a7e647d24a8ef8befbd80b7ab0562d461"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a7e647d24a8ef8befbd80b7ab0562d461">erhic::ParticleMCbase::event</a></div><div class="ttdeci">TRef event</div><div class="ttdoc">Persistent reference to the event containing this particle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00393">erhic/ParticleMC.h:393</a></div></div>
<div class="ttc" id="aclasserhic_1_1_particle_m_cbase_html_a4b859944f2d7f81868852b0f5ff18552"><div class="ttname"><a href="classerhic_1_1_particle_m_cbase.html#a4b859944f2d7f81868852b0f5ff18552">erhic::ParticleMCbase::phi</a></div><div class="ttdeci">Double32_t phi</div><div class="ttdoc">Azimuthal angle.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_particle_m_c_8h_source.html#l00380">erhic/ParticleMC.h:380</a></div></div>
<div class="ttc" id="aclasserhic_1_1_event_m_c_html"><div class="ttname"><a href="classerhic_1_1_event_m_c.html">erhic::EventMC</a></div><div class="ttdoc">Abstract base class for DIS Monte Carlo events.</div><div class="ttdef"><b>Definition:</b> <a href="erhic_2_event_m_c_8h_source.html#l00030">erhic/EventMC.h:30</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_6024b2a6014522da1306ae137ccd1549.html">erhic</a></li><li class="navelem"><a class="el" href="erhic_2_particle_m_c_8cxx.html">ParticleMC.cxx</a></li>
    <li class="footer">Generated on Mon Feb 10 2020 14:04:22 for eic-smear by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
